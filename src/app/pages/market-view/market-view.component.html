<div *ngIf="state === 'market-view'" class="w-full inline-block" style="min-width: 2600px;">

  <app-search-table [tableColumns]="tableColumns"
                    [initData]="initData"
                    (setFilteredData)="setFilteredData($event)"
                    [isSearchShown]="isSearchShown"
  ></app-search-table>

  <table mat-table [dataSource]="dataSource" matSort>

    <ng-container matColumnDef="security">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Security</th>
      <td mat-cell *matCellDef="let item">{{item.security}}</td>
    </ng-container>

    <ng-container matColumnDef="period">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Period</th>
      <td mat-cell *matCellDef="let item">{{item.period}}</td>
    </ng-container>

    <ng-container matColumnDef="currency">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Currency</th>
      <td mat-cell *matCellDef="let item">{{item.currency}}</td>
    </ng-container>

    <ng-container matColumnDef="state">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>State</th>
      <td mat-cell *matCellDef="let item">{{item.state}}</td>
    </ng-container>

    <ng-container matColumnDef="assetClass">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Asset Class</th>
      <td mat-cell *matCellDef="let item">{{item.assetClass}}</td>
    </ng-container>

    <ng-container matColumnDef="refPrice">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Ref Price</th>
      <td mat-cell *matCellDef="let item; let i = index" [class.highlight]="i === 0 && isHighlighted" (mouseleave)="unHighlight()">{{item.refPrice }}</td>
    </ng-container>

    <ng-container matColumnDef="haircut">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Haircut</th>
      <td mat-cell *matCellDef="let item">{{item.haircut }}%</td>
    </ng-container>

    <ng-container matColumnDef="repoPrice">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Repo Price</th>
      <td mat-cell *matCellDef="let item">{{item.repoPrice }}</td>
    </ng-container>

    <ng-container matColumnDef="buyerQty">
      <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-lime-500">Quantity To Lend</th>
      <td mat-cell *matCellDef="let item">{{item.buyerQty}}</td>
    </ng-container>

    <ng-container matColumnDef="buyerAmount">
      <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-lime-500">Amount To Lend</th>
      <td mat-cell *matCellDef="let item">{{item.buyerAmount }}</td>
    </ng-container>

    <ng-container matColumnDef="buyerRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-lime-500">Lender Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.buyerRate }}</td>
    </ng-container>

    <ng-container matColumnDef="sellerRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-yellow-300">Borrower Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.sellerRate }}</td>
    </ng-container>

    <ng-container matColumnDef="sellerAmount">
      <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-yellow-300">Amount To Borrow</th>
      <td mat-cell *matCellDef="let item">{{item.sellerAmount | number : '1.2-2' | noComma}}</td>
    </ng-container>

    <ng-container matColumnDef="sellerQty">
      <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-yellow-300">Quantity To Borrow</th>
      <td mat-cell *matCellDef="let item">{{item.sellerQty}}</td>
    </ng-container>

    <ng-container matColumnDef="openRepoRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Open Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.openRepoRate }}</td>
    </ng-container>

    <ng-container matColumnDef="highRepoRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>High Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.highRepoRate }}</td>
    </ng-container>

    <ng-container matColumnDef="lowRepoRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Low Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.lowRepoRate }}</td>
    </ng-container>

    <ng-container matColumnDef="lastRepoRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Last Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.lastRepoRate }}</td>
    </ng-container>

    <ng-container matColumnDef="previousCloseRepoRate">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Previous Close Repo Rate</th>
      <td mat-cell *matCellDef="let item">{{item.previousCloseRepoRate }}</td>
    </ng-container>

    <ng-container matColumnDef="repoRateChange">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Repo Rate Change</th>
      <td mat-cell *matCellDef="let item">{{item.repoRateChange }}</td>
    </ng-container>

    <ng-container matColumnDef="dailyVolume">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Daily Volume</th>
      <td mat-cell *matCellDef="let item">{{item.dailyVolume}}</td>
    </ng-container>

    <ng-container matColumnDef="dailyValue">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Daily Value</th>
      <td mat-cell *matCellDef="let item">{{item.dailyValue }}</td>
    </ng-container>

    <ng-container matColumnDef="numberOfTrades">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Number Of Trades</th>
      <td mat-cell *matCellDef="let item">{{item.numberOfTrades}}</td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Order Depth</th>
      <td mat-cell *matCellDef="let item">
        <button color="primary" mat-raised-button type="button" (click)="selectOrderDepth(item)">
          Order Depth for {{ item.security }} {{ item.period }}
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="selectOrderDepth(row)"></tr>
  </table>
</div>

<app-order-depth *ngIf="state === 'order-depth'"
                 [security]="security"
                 [period]="period"
                 (setState)="setState($event)"
></app-order-depth>
